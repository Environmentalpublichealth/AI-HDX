setwd("~/Desktop/Jiali/TAMU/Dynamics/")

#install.packages("HDMD")
library(HDMD)

data(AA54) # data not found. Found the matrix from https://github.com/cran/HDMD/blob/master/R/AA54.R
AA54 = matrix(c(
  -1.653244925,-0.942553276,-1.421026746,-0.80918391,-0.538983497,-0.685264146,-1.320408112,-1.379200491,1.690837483,0.804510701,-1.549001016,-0.817315647,-0.40944726,-0.324893145,0.582856074,0.885821427,-0.45624827,-1.346493034,-0.083627431,-0.14803237,-1.209934366,-0.402100753,-0.67155209,-0.788729254,0.620139263,-0.828571883,0.589213513,1.306947402,1.350395816,0,-1.238707352,0.766662768,-0.575472019,-0.56198068,-1.353551279,0.044329059,-0.876016261,1.423350017,-0.713698364,0.405879599,-1.849469077,0.213623787,0.973274885,-0.583368107,-1.260481241,-0.935874605,1.744584865,-0.192940898,-0.834825427,-0.014978603,-1.283101239,0.241012315,0.604470525,0.620140363,
  0.554212787,0.625646282,-0.803803669,-1.066749081,0.438518059,-0.085828313,0.885600598,-1.108769022,-0.982608745,-1.615070355,-0.51030747,-0.817315647,-0.40944726,-0.324893145,-0.135355202,-0.868280409,-0.232157764,-0.760691379,-1.049988856,-0.407738281,0.59997484,-0.839430876,-0.766248037,-1.300269924,1.696607417,-1.281343404,1.441088471,-1.457282725,-0.748060992,0,-0.76846885,1.001013833,0.143868005,0.111877783,1.597483474,1.300319074,0.126132519,-1.517082243,-1.418585637,-0.766879855,0.387054264,0.039893599,0.298170918,0.875052161,0.967578947,0.94137282,0.991479537,-0.802227945,-0.411746478,-0.551947394,0.579341963,-0.625092277,-1.20894105,0.290065654,
  1.164786197,0.69098793,-0.643608278,0.2640043,-1.326415306,1.440008355,0.725744895,-1.379200491,0.236857955,0.98597928,-0.123146219,0.144232173,-0.40944726,2.924038303,-0.687825414,0.219262729,-1.128519789,-0.799582752,1.737592177,1.669909011,-0.546806529,1.347219742,0.401668642,0.575379269,-0.87755556,0.75612844,-0.688598925,0.094565768,0.106865856,-2.179449472,-0.894965717,-1.007709577,-1.254848709,0.224187527,-0.634336319,-1.13777919,0.229803082,0.067325431,1.184462365,1.290362986,0.387054264,1.487645166,0.035630487,-0.970760991,0.792338258,-1.956971531,-1.058276705,2.24420729,-0.795971238,-1.840672492,-0.088542382,0.369324106,-0.604470525,-0.900203753,
  -0.901769959,-0.517832562,0.077270807,0.221076771,-1.788013263,-0.113075396,-1.192523549,-0.027043147,0.471370782,0.865000227,0.331403585,0.144232173,-0.40944726,2.924038303,0.969585222,1.587462161,-1.128519789,-0.077661253,1.477417948,1.669909011,-0.146570592,0.059525489,-0.403246907,0.891453163,-1.01796445,0.9825142,-0.830578084,0.579518421,1.816719551,-2.179449472,-0.289980439,-1.007709577,-1.374738713,-0.466949359,-0.14046286,-1.063897424,-0.772345698,0.524091608,1.09886891,1.192087054,0.387054264,0.766986608,1.535861523,-1.813910209,-1.285515625,-1.513187098,-1.313677642,2.041111608,-0.388002251,-1.586318854,-1.069378248,0.206795837,-0.604470525,-0.740167531,
  -0.901769959,-0.942553276,1.215128464,-0.852111439,0.954421659,-0.903240813,0.118293221,0.78425126,-0.654290787,-0.979930328,0.916518956,-0.817315647,-0.40944726,-0.324893145,0.693350116,0.32450884,1.246839576,1.101234244,-1.161492097,-1.186856016,0.416287526,-0.66935805,-0.450594881,-0.884383167,0.947760005,-1.054957643,0.873171832,-0.487377417,0.145726167,0,1.181233759,1.101450003,0.823244695,-0.466949359,0.999389571,1.595846136,-1.359812224,-0.55597008,-0.557616182,-1.153431854,0.387054264,-0.133836589,0.148147815,0.715537444,-0.584552869,0.093076912,0.395544016,-1.005323628,0.956784194,-0.308898362,0.048850969,-0.599429918,-0.604470525,1.190269407,
  1.164786197,1.703783478,-2.012335898,-0.895038967,-0.756206065,1.548996688,1.173340865,-2.460926367,1.597032352,-0.737972222,-2.003226738,-0.817315647,-0.40944726,-0.324893145,-2.34523605,-1.429592996,-1.128519789,-2.034384706,0.250882293,0.111673542,-1.674208053,1.906030455,3.368808313,-0.925971843,0.666942226,-1.054957643,0.589213513,1.161461606,-1.486406905,0,-1.99493895,0.030130851,-0.455582015,3.62803669,-1.761043829,0.265974356,1.301065571,0.909488069,-0.728803091,0.124155261,0.387054264,0.68333874,-1.764646756,-0.856821908,1.418197861,-1.191148837,0.402092758,0.17263133,-2.583263943,-0.031935512,1.548728384,1.154164563,0.604470525,0.480108669,
  0.131508119,0.233596393,0.364679988,-0.036488399,-0.430372213,-0.113075396,-0.201418187,0.513819791,-1.404731834,-0.223811248,0.591562866,0.144232173,2.320201141,-0.324893145,0.140879904,1.026149574,-1.128519789,0.216455089,0.771230753,-0.14803237,1.353260835,-0.280620163,-0.008680462,0.163651504,-0.175511112,0.031694007,0.021296874,-1.311796929,0.378888035,0,0.177508185,-0.907273407,-0.615435354,-0.216412237,0.286746977,0.265974356,-0.737788843,-1.345794927,-0.008811091,0.084844888,0.387054264,0.168582627,0.710734453,-0.651731558,-0.209037107,-0.645254711,0.074655659,0.375727012,-0.362099458,0.883737584,0.300738779,-0.302174269,-0.604470525,-0.400090557,
  -1.653244925,-1.105907397,0.400017191,-1.109676609,1.551783721,-1.420935397,-1.096610127,0.243388322,-0.232167699,0.683531648,-0.185675429,-0.817315647,-0.40944726,-0.324893145,0.41711501,0.043852546,1.515748183,0.602938209,-1.161492097,-0.823267739,0.119691631,-1.325353236,-0.434812223,-0.996672633,1.322183711,-0.919126187,1.157130152,0.143061033,0.262307101,0,0.576248481,1.670588303,1.862291396,-0.484227781,0.028543172,1.37420084,-0.599561425,0.229096785,-0.995653273,-1.369638904,0.387054264,-0.223918909,-0.226909944,1.786564829,-1.110274936,1.306611335,0.880150923,-1.045942764,1.302154981,-0.003673997,-0.302265372,-0.776927896,0,1.380312422,
  0.131508119,-0.027770201,0.45891253,2.281598134,-0.783358886,0.540854605,0.278148924,1.054682729,0.752786175,-0.52625888,0.300948972,1.105779993,2.320201141,-0.324893145,0.969585222,1.026149574,0.216023248,0.775518933,1.105740477,1.669909011,1.13923985,0.156709961,0.133363459,2.338739203,-1.626402972,2.340828762,-2.392348842,0.434032625,0.806351458,2.179449472,0.754994132,-1.141624471,-0.935142032,0.301940427,0.237923173,-1.581069783,-0.461334007,0.481269778,1.909489274,1.657259798,0.387054264,-0.256091166,0.748240229,-0.628943741,0.266616191,-1.151875878,-1.948905615,1.066252332,0.073930888,2.098982742,-0.653381713,-0.051966275,-0.604470525,-1.500339589,
  -0.901769959,-1.007894924,0.378814657,-0.895038967,0.73719909,-1.339194147,-1.000696705,0.243388322,1.128006698,-1.010175091,-0.185675429,-0.817315647,-0.40944726,-0.324893145,1.522055434,0.9559855,1.02274907,0.602938209,-1.272995338,-0.823267739,0.374999945,-0.91231923,-0.576856144,-0.797046948,1.041365932,-0.783294731,0.873171832,1.985881118,0.767491147,0,0.576248481,1.436237238,0.143868005,-0.527423836,0.002253518,1.300319074,-1.187027951,1.980033794,-1.07117691,-0.635845279,-3.32545646,-0.301132326,1.010780661,0.875052161,-1.335584393,0.324787368,0.925992117,-1.045942764,1.302154981,-0.026283209,-0.82130692,-0.212356015,1.813411575,1.060239976,
  -0.38513092,-1.334603166,0.447133462,-0.55161874,0.058378565,-1.066723313,-1.096610127,0.513819791,-1.54543953,0.623042122,0.398792363,-0.817315647,-0.40944726,-0.324893145,0.969585222,1.762872345,0.036750843,0.449803257,-0.975653362,-0.563561828,2.168899629,-1.568314416,-0.340116276,-0.551673761,0.666942226,-0.602186123,0.731192673,-1.263301663,1.700138617,0,0.592748025,0.800141492,-0.295728677,-0.708847269,0.270785287,1.004792012,-1.221584806,-1.188781554,-1.056072183,-0.694810838,0.387054264,-0.198181103,1.648378851,0.875052161,-1.310550009,0.250168747,1.161746828,-0.883466218,0.190493456,-0.161938483,-0.836572848,-0.291481619,-1.20894105,0.640144891,
  1.164786197,1.213721117,-0.3915363,0.822062169,-0.376066571,1.276525855,1.301225428,-0.027043147,-0.32597283,1.83283265,-0.154897027,1.105779993,-0.40944726,-0.324893145,-0.687825414,-0.798116335,-0.510029992,-0.451991006,1.217243718,0.215555907,-0.444851775,1.49299645,1.995717082,0.554584931,-0.737146671,0.710851288,-0.546619765,-0.341891621,-0.476038813,0,-0.380728203,-1.007709577,-1.09499537,1.554626033,-0.514154184,-1.211660955,1.404736134,-0.31807103,0.972996183,1.120018037,0.387054264,0.953585699,-0.489450376,-0.925185358,1.192888404,-0.770928179,-1.143410351,1.025633196,-0.549894706,-0.348464484,0.510645288,0.106284934,-0.604470525,-0.780176586,
  1.164786197,1.997820896,-0.530529157,0.2640043,-1.299262485,1.548996688,1.461081131,0.243388322,0.096150259,-0.52625888,-0.705346121,-0.817315647,-0.40944726,-0.324893145,-1.461283711,-1.429592996,1.202021475,-0.522481688,-0.120795178,0.111673542,-0.627696234,1.468700332,-0.419029565,0.196922403,-0.596737781,0.529742679,-0.262661446,0.046070502,-1.913870329,0,-0.842716934,-0.371613831,-1.294812044,-0.605176736,-0.734801072,-0.620606831,1.577520407,-0.023076208,0.273143818,0.589328005,0.387054264,0.715510997,-1.91466986,-1.472092959,0.892475794,0.866754198,0.271117918,-0.355417444,0.445204252,0.154590489,3.14783433,3.737508628,0.604470525,0.120027167,
  -0.38513092,-0.41982009,0.218619619,1.165482396,0.19414267,-0.085828313,-0.297331609,0.513819791,-0.513583091,0.592797359,0.299652776,1.105779993,-0.40944726,-0.324893145,-0.135355202,0.114016619,-0.599666194,0.121657088,0.8083985,0.215555907,0.037116638,-0.402100753,0.086015485,0.912247501,-1.01796445,1.027791352,-0.830578084,-0.438882152,0.495468968,0,0.224256964,-1.007709577,-0.015985334,0.077320939,-0.112295266,-1.507188018,-0.565004571,-0.484600365,1.169357637,0.969328275,0.387054264,0.310140558,0.898263333,0.214205477,0.066341118,0.03809477,-1.287482674,0.456965285,-0.198048437,-0.21280921,-0.706812461,-0.004918619,-0.604470525,-0.850192434,
  0.554212787,0.200925568,1.182147216,1.981105435,-0.267455287,0.050407104,-0.712956438,1.325114198,-0.044557437,-0.254056011,1.208428561,3.028875632,2.320201141,-0.324893145,0.41711501,-0.131557638,-0.45624827,0.911638607,0.8083985,1.669909011,-1.45007576,0.278190551,-0.592638801,1.99355307,-1.532797045,1.525840025,-1.824432203,0.046070502,-0.048575389,2.179449472,0.892490786,-1.342496812,-0.135875338,-0.052267227,0.742124689,-0.398961534,1.231951862,0.409900063,1.400963456,-0.006879315,-1.404996945,-0.037319818,-0.26441572,0.12305421,0.667166337,0.230532268,-0.783229541,0.660060968,-0.23474406,2.675517655,-0.771692654,-0.173862477,1.813411575,-2.530572773,
  0.554212787,1.115708644,-1.241984964,0.006439129,-0.756206065,1.194784605,0.789687176,-1.108769022,0.940396436,1.409405965,-1.030626293,0.144232173,-0.40944726,-0.324893145,-1.240295626,-0.903362445,-1.128519789,-1.336770331,0.325217787,0.267497089,-0.941986686,0.594040085,0.212276748,-0.198170017,-0.128708149,-0.058860298,0.021296874,0.918985279,-1.058943482,0,-1.189208584,-0.103784043,0.063941336,-0.216412237,-1.164827771,-0.251198003,1.266508717,0.876182202,0.001258727,0.641741835,0.387054264,-0.04375427,-0.789496583,-0.515004657,0.817372642,0.254096043,-0.193842763,0.010154784,-1.273014339,-0.195852301,0.052667451,-0.173862477,1.813411575,-0.180040751,
  0.131508119,0.266267217,-0.70014785,0.135221714,0.438518059,-0.031334146,0.118293221,-0.027043147,0.518273348,0.713776411,-0.57607623,0.144232173,-0.40944726,-0.324893145,-1.240295626,-0.938444482,-0.725156878,-0.619710183,0.102211305,-0.096091187,-0.706058218,0.351078905,-0.797813353,-0.07340399,-0.362722965,-0.058860298,-0.120682286,0.434032625,-0.786921303,0,-0.584223306,-0.070305319,1.063024703,-0.510145414,-0.727289688,-0.251198003,0.195246228,0.367078234,-0.06923,0.248638108,0.387054264,0.052762502,-0.789496583,0.419295827,0.01627235,0.729298843,-0.246232699,-0.355417444,0.086882284,-0.207156907,0.373251937,-0.633646396,0.604470525,-0.05001132,
  -1.653244925,-1.203919869,-0.23840842,-1.109676609,1.823311931,-1.093970396,-1.704061801,-0.027043147,0.752786175,0.018146858,-0.639901151,-0.817315647,-0.40944726,-0.324893145,-0.135355202,-0.798116335,0.395295653,-0.055784987,-0.901317867,-0.667444193,-0.272118455,-1.228168764,-0.213855014,-0.959242742,1.228577784,-0.873849035,1.015150992,0.773499483,-0.281737257,0,-0.028736797,1.570152132,1.702438058,-0.501506203,-0.454063117,0.561501418,-0.495890862,0.785780563,-1.146700546,-1.146880125,0.387054264,0.200754884,-0.4519446,1.649837929,-1.56089385,1.569740159,0.984930795,-0.761608809,1.338850604,-0.037587815,-0.061827008,-0.900962628,0.604470525,1.080244504,
  1.164786197,-0.779199156,2.020816977,-0.508691211,0.927268837,-1.066723313,0.693773754,1.054682729,-1.733049792,-1.675559881,2.181677363,0.144232173,-0.40944726,-0.324893145,0.693350116,0.499919023,1.560566285,2.024904943,-1.087156603,-1.654326656,1.124073014,-0.499285224,-0.419029565,-0.501767308,0.526533336,-0.738017579,0.589213513,-1.748254317,-0.165156323,0,2.006213684,-0.137262766,1.023061368,-0.708847269,2.232195277,0.561501418,-0.357663444,-1.74070735,-0.582790728,-1.874122021,0.387054264,-3.640612607,-0.151898392,0.100266394,0.742269489,0.336569256,0.454482694,-0.883466218,1.360436265,-0.077153937,-0.172504985,-0.415516351,-1.20894105,0.810183378,
  0.554212787,0.233596393,1.219840374,0.693279584,1.198797048,0.404619188,1.077427443,1.054682729,-0.748095918,-0.979930328,1.43489368,0.144232173,-0.40944726,-0.324893145,0.693350116,-1.148936702,1.426111981,1.198462739,-0.789814626,-1.082973651,0.686762759,0.472559495,-0.103376409,0.350800544,-0.643540744,0.348634071,-0.404640605,-0.87533954,-0.864641925,0,1.230732637,-0.27117766,1.222878041,0.129156206,1.199380248,-0.251198003,1.301065571,-0.879512788,0.338597637,-0.675155652,0.387054264,-0.757978376,-1.164554342,0.783900894,0.817372642,1.224138122,-0.311720119,-0.720989672,0.574718432,-0.207156907,0.20532673,-0.652893165,-0.604470525,0.260058862),
  nrow = 20, byrow=TRUE,
  dimnames = list(c("A", "C", "D", "E", "F", "G", "H", "I", "K", "L", "M", "N", "P", "Q", "R", "S", "T", "V", "W", "Y"),  c("Conformational parameter of beta-turn","Chou-Fasman parameter of the coil conformation","Average volume of buried residue","Residue accessible surface area in folded protein","Normalized frequency of beta-sheet","Normalized frequency of beta-turn","Normalized frequency of turn","Size","Amino acid composition","Relative mutability","Molecular weight","Number of hydrogen bond donors","Positive charge","Negative charge","Helix-coil equilibrium constant","Alpha-helix indices","Hydrophobicity factor","Residue volume","Polarity","Hydrophobicity value","Heat capacity","Normalized relative frequency of bend","Normalized relative frequency of coil","Average accessible surface area","Percentage of buried residues","Percentage of exposed residues","Transfer free energy","Relative frequency of occurrence","Average relative probability of helix","Net charge","Side chain volume","Hydropathy index","Normalized frequency of beta-sheet unweighted","Normalized frequency of left-handed alpha-helix","Refractivity","Average side chain orientation angle","Normalized frequency coil","AA composition of total proteins","Average non-bonded energy per atom","Long range non-bonded energy per atom","Average non-bonded energy per residue","Optimized propensity to form reverse turn","Relative frequency in alpha-helix","Information measure for pleated-sheet","Information measure for loop","Normalized frequency of extended structure","Average interactions per side chain atom","Polar requirement","Bulkiness","Isolelectric point","Free energy in alpha-helical region","Free energy in beta-strand region","Number of codon(s)","Solvation free energy"))
)

AminoAcids = c("A", "C", "D", "E", "F", "G", "H", "I", "K", "L", "M", "N", "P", "Q", "R", "S", "T", "V", "W", "Y")
AAbyGroup = c("aliphatic", "cysteine", "acidic", "acidic", "aromatic", "aliphatic", "basic", "aliphatic", "basic", "aliphatic", "aliphatic", "aminic", "proline", "aminic", "basic", "hydroxylated", "hydroxylated", "aliphatic", "aromatic", "aromatic")



AA54_PCA = princomp(AA54, covmat = cov.wt(AA54))

Factor54 = factor.pa.ginv(AA54, nfactors = 5, m=4, prerotate=TRUE, rotate="Promax", scores="regression")
Factor54$loadings
Factor54$loadings[order(Factor54$loadings[,1]),]  

data = data.frame(Factor54$scores[,1:3])
data$AA = rownames(data)
data$class = AAbyGroup

library(ggplot2)
ggplot(data = data, aes(x=F1, y=F2, color=class))+
  geom_point()+
  geom_text(aes(label=AA),hjust=0, vjust=0)+
  theme_bw(base_size = 16)

var = data.frame(variable = c("F1","F2","F3","F4","F5"), value = c(0.292,0.478,0.654,0.763,0.839))

ggplot(data = var, aes(x=variable, y = value))+
  geom_bar(stat = "identity", color = "black",fill = "white")+
  geom_text(aes(label=value),vjust=-0.3, size=3.5) +
  ylim(c(0,1))+
  labs(x="", y="accumulative variance")+
  theme_bw(base_size = 16)

#install.packages("plot3D")
library(plot3D)
text3D(data$F1,data$F2, data$F3, bty = "g", pch = 12, 
       labels = data$AA,
          col = as.integer(data$class), 
          pch = 18, ticktype = "detailed",
          colkey = list(at = c(2, 3, 4), side = 1, 
                        addlines = TRUE, length = 0.5, width = 0.5 ))

AAvector <- data.frame(Factor54$scores)

write.csv(AAvector,"dataset/HDMDvector.csv")
